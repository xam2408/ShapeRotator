<!DOCTYPE html>

<html>
<head>
</head>

<body style="background: black; color: white;">
    <svg id="stage" width="600" height="600" style="border: 1px solid gray"></svg>

    <script>

	const svg = document.getElementById('stage')
        const edges = [
            [0, 1], [1, 2], [2, 3], [3, 0],
            [4, 5], [5, 6], [6, 7], [7, 4],
            [0, 4], [1, 5], [2, 6], [3, 7],
           
            [8, 9], [9, 10], [10, 11], [11, 8], 
            [12, 13], [13, 14], [14, 15], [15, 12],
            [8, 12], [9, 13], [10, 14], [11, 15],

            [8, 0], [9, 1], [10, 2], [11, 3],
            [12, 4], [13, 5], [14, 6], [15, 7]
        ];

	function createShape(pointsCount, edgesDef) {
 	   edgesDef.forEach((pair, i) => {
  	      const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
  	      line.id = "l" + i;           
  	      line.setAttribute("stroke", "lime");
  	      line.setAttribute("stroke-width", "2");
  	      svg.appendChild(line);          
 	   });

	    for (let i = 0; i < pointsCount; i++) {
 	       const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
 	       circle.id = "p" + i;            
 	       circle.setAttribute("r", "2");
 	       circle.setAttribute("fill", "lime");
 	       svg.appendChild(circle);        
	    }
	}


	createShape(16, edges);

        async function updateAnimation(){
            try{
                const response = await fetch('data');
                const points = await response.json();
                points.forEach((point, index) => {
                    const circle = document.getElementById('p' + index);
                    if (circle){
                        circle.setAttribute('cx', point.x);
                        circle.setAttribute('cy', point.y);
                    }
                });
                edges.forEach((pair, i) => {
                    const pA = points[pair[0]];
                    const pB = points[pair[1]];
                    const line = document.getElementById('l' + i);
                    if (line){
                        line.setAttribute('x1', pA.x);
                        line.setAttribute('y1', pA.y);
                        line.setAttribute('x2', pB.x);
                        line.setAttribute('y2', pB.y);

                    }
                });
            }
            catch (error){
                console.error("Data ERROR: ", error);
            }
            requestAnimationFrame(updateAnimation);
        }
        updateAnimation();

    </script>
</body>
</html>
